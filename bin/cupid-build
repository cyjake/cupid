#!/usr/bin/env node

var exists = require('fs').existsSync
var join = require('path').join
var resolve = require('path').resolve
var cupid = require('../')
var log = require('../lib/utils').log
var error = require('../lib/utils').error


var args = process.argv.slice(2)
var dir = args.length > 0 ? args[0] : ''
var planet = resolve(process.cwd(), dir)

if (!exists(join(planet, 'planet.json'))) {
  error('cannot find planet folder to build')
  process.exit(1)
}

var data = require(join(planet, 'planet.json'))

data.dir = planet
cupid.build(data).done(function(data) {
  log('done', 'build ' + data.title + ' succeed')
  log('done', 'check the build result at ' + data.dir)
  process.exit(0)
})

process.stdin.resume()
